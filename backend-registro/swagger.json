{
  "openapi": "3.0.3",
  "info": {
    "title": "MathKids API",
    "description": "API do MathKids - Aplicativo de ensino de matem√°tica para crian√ßas de 3 a 9 anos.\n\nEsta API gerencia o sistema de autentica√ß√£o de respons√°veis e futuramente incluir√° endpoints para m√≥dulos educativos, progresso das crian√ßas e gamifica√ß√£o.\n\n## Funcionalidades Atuais\n- Registro de respons√°veis/pais\n- Sistema de autentica√ß√£o seguro\n- Valida√ß√£o de dados\n\n## Funcionalidades Futuras\n- Login de usu√°rios\n- Gest√£o de perfis de crian√ßas\n- M√≥dulos educativos de matem√°tica\n- Sistema de progresso e recompensas\n\n## Como testar\n1. Acesse https://editor.swagger.io/\n2. Importe este arquivo JSON\n3. Use 'Try it out' para testar os endpoints",
    "version": "1.0.0",
    "contact": {
      "name": "MathKids Team",
      "url": "https://github.com/abe-karin/mathkids",
      "email": "contato@mathkids.com"
    },
    "license": {
      "name": "ISC",
      "url": "https://opensource.org/licenses/ISC"
    }
  },
  "servers": [
    {
      "url": "https://mathkids-back.onrender.com",
      "description": "üåê Servidor de Produ√ß√£o (Render)"
    },
    {
      "url": "http://localhost:5000",
      "description": "üè† Servidor de desenvolvimento local (porta 5000)"
    },
    {
      "url": "http://localhost:3000",
      "description": "üè† Servidor alternativo local (porta 3000)"
    }
  ],
  "tags": [
    {
      "name": "Autentica√ß√£o",
      "description": "Endpoints para registro e login de respons√°veis/pais"
    },
    {
      "name": "P√°ginas",
      "description": "Rotas para servir p√°ginas HTML do frontend"
    },
    {
      "name": "Educativo",
      "description": "Endpoints para m√≥dulos educativos (futuro)"
    }
  ],
  "paths": {
    "/": {
      "get": {
        "tags": ["P√°ginas"],
        "summary": "P√°gina inicial - Bem-vindo ao Mundo M√°gico",
        "description": "Serve a p√°gina principal de boas-vindas do MathKids com tema infantil",
        "responses": {
          "200": {
            "description": "P√°gina inicial carregada com sucesso",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string",
                  "example": "<!DOCTYPE html><html><head><title>Bem-vindo ao Mundo M√°gico!</title>..."
                }
              }
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "tags": ["Sistema"],
        "summary": "üè• Verifica√ß√£o de sa√∫de do servidor",
        "description": "Endpoint b√°sico de health check para verificar se o servidor est√° funcionando corretamente",
        "responses": {
          "200": {
            "description": "‚úÖ Servidor funcionando corretamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                },
                "examples": {
                  "success": {
                    "summary": "Servidor saud√°vel",
                    "value": {
                      "status": "OK",
                      "timestamp": "2024-01-15T10:30:00.000Z",
                      "service": "MathKids API"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/health/database": {
      "get": {
        "tags": ["Sistema"],
        "summary": "üóÑÔ∏è Verifica√ß√£o de conectividade com banco de dados",
        "description": "Verifica se a conex√£o com o banco de dados PostgreSQL est√° funcionando corretamente",
        "responses": {
          "200": {
            "description": "‚úÖ Banco de dados conectado e funcionando",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatabaseHealthResponse"
                },
                "examples": {
                  "success": {
                    "summary": "Banco conectado com sucesso",
                    "value": {
                      "status": "OK",
                      "database": "connected",
                      "timestamp": "2024-01-15T10:30:00.000Z",
                      "query_time": "12ms"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "‚ùå Erro de conex√£o com o banco de dados",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErroResponse"
                },
                "examples": {
                  "database_error": {
                    "summary": "Falha na conex√£o com banco",
                    "value": {
                      "status": "ERROR",
                      "database": "disconnected",
                      "error": "Connection timeout",
                      "timestamp": "2024-01-15T10:30:00.000Z"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/cadastro": {
      "get": {
        "tags": ["P√°ginas"],
        "summary": "P√°gina de cadastro de respons√°veis",
        "description": "Serve a p√°gina de cadastro para pais/respons√°veis",
        "responses": {
          "200": {
            "description": "P√°gina de cadastro carregada com sucesso",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string",
                  "example": "<!DOCTYPE html><html><head><title>Cadastro - MathKids</title>..."
                }
              }
            }
          }
        }
      }
    },
    "/api/register": {
      "post": {
        "tags": ["Autentica√ß√£o"],
        "summary": "Registrar novo respons√°vel/pai",
        "description": "Cria uma nova conta para respons√°vel no sistema MathKids.\n\n### Valida√ß√µes Implementadas:\n- ‚úÖ Todos os campos s√£o obrigat√≥rios\n- ‚úÖ Email deve ser √∫nico no sistema\n- ‚úÖ Senha √© criptografada com bcrypt (10 rounds)\n- ‚úÖ Termos devem ser aceitos (true)\n- ‚úÖ Data de nascimento deve ser v√°lida\n\n### Seguran√ßa:\n- üîê Senhas hasheadas com bcrypt\n- üîí Conex√£o SSL com PostgreSQL\n- üõ°Ô∏è Valida√ß√£o contra SQL injection\n- üìß Verifica√ß√£o de email duplicado",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RegistroRequest"
              },
              "examples": {
                "exemplo_completo": {
                  "summary": "‚úÖ Exemplo de registro completo e v√°lido",
                  "value": {
                    "nomeDoResponsavel": "Maria Silva Santos",
                    "email": "maria.santos@email.com",
                    "senha": "minhasenhasegura123",
                    "dataDeNascimento": "1985-03-15",
                    "termosAceitos": true
                  }
                },
                "exemplo_minimo": {
                  "summary": "‚úÖ Exemplo m√≠nimo v√°lido",
                  "value": {
                    "nomeDoResponsavel": "Jo√£o",
                    "email": "joao@teste.com",
                    "senha": "123456",
                    "dataDeNascimento": "1990-01-01",
                    "termosAceitos": true
                  }
                },
                "exemplo_erro": {
                  "summary": "‚ùå Exemplo que gerar√° erro (email duplicado)",
                  "value": {
                    "nomeDoResponsavel": "Usu√°rio Teste",
                    "email": "usuario@existente.com",
                    "senha": "senha123",
                    "dataDeNascimento": "1988-12-25",
                    "termosAceitos": true
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "‚úÖ Usu√°rio registrado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RegistroSucessoResponse"
                },
                "examples": {
                  "sucesso": {
                    "summary": "Registro bem-sucedido",
                    "value": {
                      "message": "Usu√°rio registrado com sucesso!",
                      "user": {
                        "id": 42,
                        "email": "maria.santos@email.com",
                        "nome_responsavel": "Maria Silva Santos"
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "‚ùå Dados inv√°lidos ou campos obrigat√≥rios ausentes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErroResponse"
                },
                "examples": {
                  "campos_obrigatorios": {
                    "summary": "Campos obrigat√≥rios faltando",
                    "value": {
                      "message": "Erro: Todos os campos s√£o obrigat√≥rios, incluindo a aceita√ß√£o dos termos."
                    }
                  },
                  "email_invalido": {
                    "summary": "Email com formato inv√°lido",
                    "value": {
                      "message": "Erro: Email deve ter um formato v√°lido."
                    }
                  },
                  "termos_nao_aceitos": {
                    "summary": "Termos n√£o aceitos",
                    "value": {
                      "message": "Erro: √â necess√°rio aceitar os termos de uso."
                    }
                  }
                }
              }
            }
          },
          "409": {
            "description": "‚ùå Conflito - Email j√° est√° em uso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErroResponse"
                },
                "examples": {
                  "email_duplicado": {
                    "summary": "Email j√° cadastrado no sistema",
                    "value": {
                      "message": "Erro: O e-mail fornecido j√° est√° em uso."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "‚ùå Erro interno do servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErroResponse"
                },
                "examples": {
                  "erro_servidor": {
                    "summary": "Erro do servidor ou banco de dados",
                    "value": {
                      "message": "Erro interno do servidor ao tentar registrar o usu√°rio."
                    }
                  },
                  "erro_banco": {
                    "summary": "Erro de conex√£o com banco",
                    "value": {
                      "message": "Erro de conex√£o com o banco de dados."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/login": {
      "post": {
        "tags": ["Autentica√ß√£o"],
        "summary": "üîë Fazer login no sistema",
        "description": "Autentica um usu√°rio registrado no sistema MathKids.\n\n### Credenciais de Teste:\n- **Admin:** `adm@email.com` / `123456`\n- **Usu√°rio:** Use credenciais de um usu√°rio registrado\n\n### Funcionalidades:\n- üîê Verifica√ß√£o de senha com bcrypt\n- üîí Autentica√ß√£o segura\n- üíæ Op√ß√£o de \"Lembrar-me\"\n- üéØ Redirecionamento autom√°tico",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              },
              "examples": {
                "admin_login": {
                  "summary": "üëë Login como Administrador",
                  "value": {
                    "email": "adm@email.com",
                    "senha": "123456",
                    "rememberMe": true
                  }
                },
                "user_login": {
                  "summary": "üë§ Login de Usu√°rio Normal",
                  "value": {
                    "email": "maria.santos@email.com",
                    "senha": "minhasenha123",
                    "rememberMe": false
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "‚úÖ Login realizado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoginSucessoResponse"
                },
                "examples": {
                  "login_success": {
                    "summary": "Login bem-sucedido",
                    "value": {
                      "message": "Login realizado com sucesso!",
                      "user": {
                        "id": 1,
                        "email": "maria.santos@email.com",
                        "nome": "Maria Silva Santos",
                        "tipo": "usuario"
                      },
                      "token": "token_1_1642234567890",
                      "rememberMe": true
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "‚ùå Dados inv√°lidos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErroResponse"
                },
                "examples": {
                  "campos_obrigatorios": {
                    "summary": "Campos obrigat√≥rios faltando",
                    "value": {
                      "message": "Erro: Email e senha s√£o obrigat√≥rios."
                    }
                  },
                  "email_invalido": {
                    "summary": "Formato de email inv√°lido",
                    "value": {
                      "message": "Erro: Formato de email inv√°lido."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "‚ùå Credenciais inv√°lidas",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErroResponse"
                },
                "examples": {
                  "credenciais_incorretas": {
                    "summary": "Email ou senha incorretos",
                    "value": {
                      "message": "Erro: Email ou senha incorretos."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "‚ùå Erro interno do servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErroResponse"
                },
                "examples": {
                  "erro_servidor": {
                    "summary": "Erro do servidor",
                    "value": {
                      "message": "Erro interno do servidor ao tentar fazer login."
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "RegistroRequest": {
        "type": "object",
        "required": [
          "nomeDoResponsavel",
          "email",
          "senha",
          "dataDeNascimento",
          "termosAceitos"
        ],
        "properties": {
          "nomeDoResponsavel": {
            "type": "string",
            "description": "Nome completo do respons√°vel/pai da crian√ßa",
            "example": "Maria Silva Santos",
            "minLength": 2,
            "maxLength": 255,
            "pattern": "^[A-Za-z√Ä-√ø\\s]+$"
          },
          "email": {
            "type": "string",
            "format": "email",
            "description": "Email √∫nico do respons√°vel (usado para login)",
            "example": "maria.santos@email.com",
            "maxLength": 255
          },
          "senha": {
            "type": "string",
            "description": "Senha do usu√°rio (ser√° criptografada com bcrypt)",
            "example": "minhasenhasegura123",
            "minLength": 6,
            "maxLength": 100
          },
          "dataDeNascimento": {
            "type": "string",
            "format": "date",
            "description": "Data de nascimento do respons√°vel no formato YYYY-MM-DD",
            "example": "1985-03-15"
          },
          "termosAceitos": {
            "type": "boolean",
            "description": "Confirma√ß√£o obrigat√≥ria de aceita√ß√£o dos termos de uso",
            "example": true,
            "enum": [true]
          }
        }
      },
      "RegistroSucessoResponse": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "description": "Mensagem de confirma√ß√£o do registro",
            "example": "Usu√°rio registrado com sucesso!"
          },
          "user": {
            "$ref": "#/components/schemas/UsuarioResponse"
          }
        }
      },
      "LoginRequest": {
        "type": "object",
        "required": [
          "email",
          "senha"
        ],
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "description": "Email do usu√°rio registrado",
            "example": "maria.santos@email.com"
          },
          "senha": {
            "type": "string",
            "description": "Senha do usu√°rio",
            "example": "minhasenha123",
            "minLength": 3
          },
          "rememberMe": {
            "type": "boolean",
            "description": "Manter usu√°rio logado",
            "example": false,
            "default": false
          }
        }
      },
      "LoginSucessoResponse": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "description": "Mensagem de confirma√ß√£o do login",
            "example": "Login realizado com sucesso!"
          },
          "user": {
            "type": "object",
            "properties": {
              "id": {
                "type": "integer",
                "description": "ID do usu√°rio",
                "example": 1
              },
              "email": {
                "type": "string",
                "format": "email",
                "description": "Email do usu√°rio",
                "example": "maria.santos@email.com"
              },
              "nome": {
                "type": "string",
                "description": "Nome do usu√°rio",
                "example": "Maria Silva Santos"
              },
              "tipo": {
                "type": "string",
                "description": "Tipo de usu√°rio",
                "example": "usuario",
                "enum": ["usuario", "admin"]
              }
            }
          },
          "token": {
            "type": "string",
            "description": "Token de autentica√ß√£o",
            "example": "token_1_1642234567890"
          },
          "rememberMe": {
            "type": "boolean",
            "description": "Se o usu√°rio escolheu ser lembrado",
            "example": true
          }
        }
      },
      "UsuarioResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "ID √∫nico do usu√°rio no banco PostgreSQL",
            "example": 42
          },
          "email": {
            "type": "string",
            "format": "email",
            "description": "Email do usu√°rio registrado",
            "example": "maria.santos@email.com"
          },
          "nome_responsavel": {
            "type": "string",
            "description": "Nome do respons√°vel cadastrado",
            "example": "Maria Silva Santos"
          }
        }
      },
      "ErroResponse": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "description": "Descri√ß√£o detalhada do erro ocorrido",
            "example": "Erro: Todos os campos s√£o obrigat√≥rios, incluindo a aceita√ß√£o dos termos."
          }
        }
      },
      "CriancaProfile": {
        "type": "object",
        "description": "Perfil da crian√ßa (implementa√ß√£o futura)",
        "properties": {
          "id": {
            "type": "integer",
            "example": 1
          },
          "nome": {
            "type": "string",
            "example": "Jo√£o Pedro"
          },
          "idade": {
            "type": "integer",
            "minimum": 3,
            "maximum": 9,
            "example": 6
          },
          "nivel_matematica": {
            "type": "string",
            "enum": ["iniciante", "basico", "intermediario"],
            "example": "basico"
          },
          "responsavel_id": {
            "type": "integer",
            "example": 42
          }
        }
      },
      "HealthResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "description": "Status do servidor",
            "example": "OK",
            "enum": ["OK"]
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp ISO 8601 da verifica√ß√£o",
            "example": "2024-01-15T10:30:00.000Z"
          },
          "service": {
            "type": "string",
            "description": "Nome do servi√ßo",
            "example": "MathKids API"
          }
        },
        "required": ["status", "timestamp", "service"]
      },
      "DatabaseHealthResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "description": "Status da conex√£o com banco",
            "example": "OK",
            "enum": ["OK", "ERROR"]
          },
          "database": {
            "type": "string",
            "description": "Status da conectividade",
            "example": "connected",
            "enum": ["connected", "disconnected"]
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp da verifica√ß√£o",
            "example": "2024-01-15T10:30:00.000Z"
          },
          "query_time": {
            "type": "string",
            "description": "Tempo de resposta da consulta de teste",
            "example": "12ms"
          },
          "error": {
            "type": "string",
            "description": "Mensagem de erro (apenas em caso de falha)",
            "example": "Connection timeout"
          }
        },
        "required": ["status", "database", "timestamp"]
      }
    },
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "Token JWT para autentica√ß√£o (implementa√ß√£o futura para login)"
      }
    }
  },
  "security": [],
  "externalDocs": {
    "description": "üìö Documenta√ß√£o completa do MathKids no GitHub",
    "url": "https://github.com/abe-karin/mathkids/blob/main/README.md"
  }
}